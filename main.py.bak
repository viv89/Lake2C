# -*- coding: utf-8 -*-
"""
Created on Mon May  9 14:39:01 2022

@author: vija
"""
import numpy as np
from funcs.io import read_data
from funcs.air import saturated_pressure
from modules.physics import lake

weather_file   = 'input/CHE_ZH_Dubendorf.AP.066099_TMYx.epw'
profiles_file  = 'input/profiles.xlsx' 

#%% Boundary conditions 
data = read_data(weather_file, profiles_file)
data['Psat'] = saturated_pressure(data['Te'].values) #kPa
data['Pe']   = np.multiply(data['Psat'],data['RHe']/100)

#%% Lake data
lake_data = {'surf_area': 1200,
             'length'   : 30,
             'width'    : 50,
             'volume'   : 18000,
             'extinction_coeff': 0.6,
             'wtemp_init': 5.0}

params = {'nz'  : 30,
          'nt'  : 8760,
          'dt'  : 3600}  # 1 time-step = seconds per day

properties = {'nu'   : 1e-6, # viscosity (?)
              'g'    : 9.81, # gravity acceleration (m/s2)
              'rho_0': 998.2,# ref water density (kg/m3)
              'cp'   : 4183, # specific heat J/(kg K)
              'eps'  : 0.99, # emissivity of lake water surface
              'alpha': 0.7}  # absorption coeff water

#%% Run lake model
# Initialize lake object
lk = lake(lake_data, params, properties)
# Run lake model
lk.run(data)
# Get simulation output
output = lk.hist


    
    

    